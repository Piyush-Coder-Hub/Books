/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/5.4/userguide/java_library_plugin.html
 */
plugins {
    // Apply the java-library plugin to add support for Java Library
    id 'java'
    id 'java-library'
    id 'application'
    id 'com.github.johnrengelman.shadow' version '7.0.0'
}
   // sourceCompatibility = 1.8
    //targetCompatibility = 1.8
repositories {
    // Use jcenter for resolving your dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}
mainClassName='com.rest.BookApplication'
dependencies {
    // This dependency is exported to consumers, that is to say found on their compile classpath.
    api 'io.dropwizard:dropwizard-core:1.2.3'
    api 'com.google.inject:guice:4.0'
    api 'com.hubspot.dropwizard:dropwizard-guice:1.3.5.0'
    api 'mysql:mysql-connector-java:8.0.15'
    api 'org.jadira.usertype:usertype.core:3.1.0.GA'
    api 'javax.activation:activation:1.1.1'
    api 'javax.mail:mail:1.4.5'
    api 'com.google.inject.extensions:guice-assistedinject:4.0'
    api 'com.google.inject.extensions:guice-servlet:4.0'
    api 'javax.validation:validation-api:1.0.0.GA'
    api 'org.javassist:javassist:3.23.1-GA'
	shadow 'io.dropwizard:dropwizard-core:1.2.3'
	shadow 'javax.xml.bind:jaxb-api:2.3.0'
	shadow 'com.google.inject:guice:4.0'
	shadow 'com.hubspot.dropwizard:dropwizard-guice:1.3.5.0'
	shadow 'mysql:mysql-connector-java:8.0.15'
	shadow 'org.jadira.usertype:usertype.core:3.1.0.GA'
	shadow 'javax.activation:activation:1.1.1'
	shadow 'javax.mail:mail:1.4.5'
	shadow 'com.google.inject.extensions:guice-assistedinject:4.0'
	shadow 'com.google.inject.extensions:guice-servlet:4.0'
	shadow 'javax.validation:validation-api:1.0.0.GA'
	shadow 'org.javassist:javassist:3.23.1-GA'
    // This dependency is used internally, and not exposed to consumers on their own compile classpath.
    implementation 'io.dropwizard:dropwizard-core:1.2.3'
    // https://mvnrepository.com/artifact/javax.xml.bind/jaxb-api
    implementation 'javax.xml.bind:jaxb-api:2.3.0'
    implementation 'com.google.inject:guice:4.0'
    implementation 'com.hubspot.dropwizard:dropwizard-guice:1.3.5.0'
    implementation 'io.dropwizard:dropwizard-hibernate:1.2.3'
    implementation 'javax.activation:activation:1.1.1'
    implementation 'javax.mail:mail:1.4.5'
    implementation 'com.google.inject.extensions:guice-assistedinject:4.0'
    implementation 'javax.validation:validation-api:1.0.0.GA'
    implementation 'org.javassist:javassist:3.23.1-GA'
    configurations.all {
 	exclude group: "org.jadira.usertype", module: "usertype.core"
 	//exclude group: "com.google.inject.extensions", module: "guice-servlet"
 	//exclude group: "com.sun.jersey",module:"jersey-core"
	}
    implementation 'mysql:mysql-connector-java:8.0.15'
    implementation 'com.google.inject.extensions:guice-servlet:4.0'

    // Use JUnit test framework
    testImplementation 'junit:junit:4.12'
}

jar {
  manifest {
    attributes(
     'Class-Path': configurations.runtimeClasspath.files.collect { it.getName() }.join(' '),
      'Main-Class': 'book.rest.BookApplication'
    )
  }
 } 
 // shadowJar {
  //  destinationDir = file("${buildDir}/dist")
//}

shadowJar {
    mergeServiceFiles()
    exclude 'META-INF/*.DSA'
    exclude 'META-INF/*.RSA'
}

//task customFlatJar(type: Jar){
// manifest {
		// attributes 'Main-Class': 'book.rest.BookApplication'
  //  }
    //baseName ='DemoBooks'
    //duplicatesStrategy = DuplicatesStrategy.INCLUDE 
    //from{configurations.runtimeClasspath.files.collect { it.isDirectory() ? it : zipTree(it)}}
    //with jar
//}

//task runApp(type: JavaExec) {
  //  main = "book.rest.BookApplication"
    //classpath = shadowJar.archiveFile // use archivePath before Gradle 5.1
//}
